<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>GainGrid - Earn Daily Rewards</title>

  <!-- === AdSense / providers: keep scripts async (do not auto-insert ad units here) === -->
  <!-- AdSense script (kept async) -->
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"
          crossorigin="anonymous"></script>

  <!-- Canonical & site metadata (helps AdSense review & SEO) -->
  <link rel="canonical" href="https://swanybz.github.io/" />
  <meta name="description" content="GainGrid — watch ads, complete tasks and earn G-Coins. Telegram-integrated rewards & withdrawals in USD, BTC, USDT." />
  <meta name="referrer" content="no-referrer-when-downgrade" />
  <meta name="robots" content="index, follow" />
  <meta name="theme-color" content="#0f1419" />

  <!-- JSON-LD organization + site info (non-invasive, helps review) -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "Organization",
    "name": "GainGrid",
    "url": "https://swanybz.github.io",
    "logo": "https://swanybz.github.io/logo.png",
    "sameAs": []
  }
  </script>

  <!-- Cookie/consent placeholder: add real CMP later -->
  <meta name="ads:consent" content="unknown">

  <!-- KEEP your element SDK includes / font includes -->
  <script src="/_sdk/element_sdk.js"></script>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
  <script src="https://cdn.tailwindcss.com" type="text/javascript"></script>

  <!-- ===== Your original styles (kept exactly) ===== -->
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: 'Inter', -webkit-system, BlinkMacSystemFont, sans-serif; background: linear-gradient(135deg, #0f1419 0%, #1a2332 50%, #0f1419 100%); color: #ffffff; overflow-x: hidden; box-sizing: border-box; }
    html, body { height: 100%; }

    /* Animated background particles */
    .bg-particles { position: fixed; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 1; }
    .particle { position: absolute; width: 4px; height: 4px; background: linear-gradient(45deg, #ff6b9d, #c471ed, #12c2e9); border-radius: 50%; animation: float 6s ease-in-out infinite; }
    @keyframes float { 0%, 100% { transform: translateY(0px) rotate(0deg); opacity: 0.7; } 50% { transform: translateY(-20px) rotate(180deg); opacity: 1; } }

    /* Header */
    .header { position: fixed; top: 0; width: 100%; background: rgba(15, 20, 25, 0.95); backdrop-filter: blur(10px); border-bottom: 1px solid rgba(255, 107, 157, 0.2); z-index: 1000; padding: 1rem 0; }
    .nav-container { max-width: 1200px; margin: 0 auto; display: flex; justify-content: space-between; align-items: center; padding: 0 2rem; }
    .logo { font-size: 1.8rem; font-weight: 700; background: linear-gradient(45deg, #ff6b9d, #c471ed, #12c2e9); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; }
    .nav-menu { display: flex; list-style: none; gap: 2rem; }
    .nav-link { color: #ffffff; text-decoration: none; font-weight: 500; transition: all 0.3s ease; position: relative; }
    .nav-link:hover { color: #ff6b9d; }
    .nav-link::after { content: ''; position: absolute; bottom: -5px; left: 0; width: 0; height: 2px; background: linear-gradient(45deg, #ff6b9d, #c471ed); transition: width 0.3s ease; }
    .nav-link:hover::after { width: 100%; }

    /* Main content */
    .main-content { position: relative; z-index: 10; padding-top: 80px; }

    /* Hero Section */
    .hero { min-height: 90vh; display: flex; align-items: center; justify-content: center; text-align: center; padding: 2rem; position: relative; }
    .hero-content { max-width: 800px; animation: fadeInUp 1s ease-out; }
    .hero-headline { font-size: 3.5rem; font-weight: 800; margin-bottom: 1.5rem; background: linear-gradient(45deg, #ffffff, #ff6b9d, #c471ed); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; line-height: 1.2; }
    .hero-subtitle { font-size: 1.3rem; color: #b0b8c1; margin-bottom: 3rem; font-weight: 400; }
    .cta-buttons { display: flex; gap: 1.5rem; justify-content: center; flex-wrap: wrap; }
    .btn { padding: 1rem 2.5rem; border: none; border-radius: 50px; font-size: 1.1rem; font-weight: 600; cursor: pointer; transition: all 0.3s ease; text-decoration: none; display: inline-block; position: relative; overflow: hidden; }
    .btn-primary { background: linear-gradient(45deg, #ff6b9d, #c471ed, #12c2e9); color: #ffffff; box-shadow: 0 10px 30px rgba(255, 107, 157, 0.3); }
    .btn-primary:hover { transform: translateY(-3px); box-shadow: 0 15px 40px rgba(255, 107, 157, 0.4); }
    .btn-secondary { background: transparent; color: #ffffff; border: 2px solid #ff6b9d; }
    .btn-secondary:hover { background: rgba(255, 107, 157, 0.1); transform: translateY(-3px); }

    /* Dashboard Preview */
    .dashboard-preview { margin: 4rem 0; position: relative; }
    .dashboard-mockup { max-width: 600px; margin: 0 auto; background: rgba(26, 35, 50, 0.8); border-radius: 20px; padding: 2rem; border: 1px solid rgba(255, 107, 157, 0.2); box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3); animation: float 6s ease-in-out infinite; }
    .mockup-header { display: flex; gap: 0.5rem; margin-bottom: 1.5rem; }
    .mockup-dot { width: 12px; height: 12px; border-radius: 50%; }
    .dot-red { background: #ff5f57; } .dot-yellow { background: #ffbd2e; } .dot-green { background: #28ca42; }
    .mockup-content { background: linear-gradient(135deg, #1a2332, #0f1419); border-radius: 10px; padding: 1.5rem; text-align: left; }
    .mockup-title { color: #ff6b9d; font-size: 1.2rem; margin-bottom: 1rem; }
    .mockup-stats { display: grid; grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); gap: 1rem; }
    .stat-card { background: rgba(255, 107, 157, 0.1); padding: 1rem; border-radius: 8px; text-align: center; }
    .stat-value { font-size: 1.5rem; font-weight: 700; color: #12c2e9; }
    .stat-label { font-size: 0.9rem; color: #b0b8c1; }

    /* About Section */
    .about { padding: 6rem 2rem; background: linear-gradient(135deg, rgba(26, 35, 50, 0.5), rgba(15, 20, 25, 0.8)); }
    .about-container { max-width: 1200px; margin: 0 auto; text-align: center; }
    .about-heading { font-size: 2.5rem; font-weight: 700; margin-bottom: 2rem; background: linear-gradient(45deg, #ff6b9d, #c471ed); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; }
    .about-description { font-size: 1.2rem; color: #b0b8c1; margin-bottom: 4rem; max-width: 800px; margin-left: auto; margin-right: auto; line-height: 1.6; }
    .features-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 2rem; margin-top: 3rem; }
    .feature-card { background: rgba(26, 35, 50, 0.6); padding: 2rem; border-radius: 15px; border: 1px solid rgba(255, 107, 157, 0.2); transition: all 0.3s ease; text-align: center; }
    .feature-card:hover { transform: translateY(-10px); box-shadow: 0 20px 40px rgba(255, 107, 157, 0.2); }
    .feature-icon { font-size: 3rem; margin-bottom: 1rem; background: linear-gradient(45deg, #ff6b9d, #c471ed, #12c2e9); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; }
    .feature-title { font-size: 1.3rem; font-weight: 600; margin-bottom: 1rem; color: #ffffff; }
    .feature-description { color: #b0b8c1; line-height: 1.5; }

    /* Footer */
    .footer { background: rgba(15, 20, 25, 0.9); padding: 3rem 2rem 2rem; border-top: 1px solid rgba(255, 107, 157, 0.2); }
    .footer-container { max-width: 1200px; margin: 0 auto; text-align: center; }
    .social-links { display: flex; justify-content: center; gap: 1.5rem; margin-bottom: 2rem; }
    .social-link { display: inline-flex; align-items: center; justify-content: center; width: 50px; height: 50px; background: linear-gradient(45deg, #ff6b9d, #c471ed); border-radius: 50%; color: #ffffff; text-decoration: none; font-size: 1.5rem; transition: all 0.3s ease; }
    .social-link:hover { transform: translateY(-3px) scale(1.1); box-shadow: 0 10px 25px rgba(255, 107, 157, 0.4); }
    .footer-text { color: #b0b8c1; font-size: 0.9rem; }

    /* Animations */
    @keyframes fadeInUp { from { opacity: 0; transform: translateY(30px); } to { opacity: 1; transform: translateY(0); } }
    @keyframes glow { 0%, 100% { box-shadow: 0 0 20px rgba(255, 107, 157, 0.3); } 50% { box-shadow: 0 0 40px rgba(255, 107, 157, 0.6); } }

    /* Responsive */
    @media (max-width: 768px) {
      .nav-menu { display: none; }
      .hero-headline { font-size: 2.5rem; }
      .hero-subtitle { font-size: 1.1rem; }
      .cta-buttons { flex-direction: column; align-items: center; }
      .btn { width: 100%; max-width: 300px; }
      .features-grid { grid-template-columns: 1fr; }
      .about-heading { font-size: 2rem; }
    }

    /* === AD PLAYER + CIRCLE UI (hidden by default; only shown for deeplink) === */
    /* We'll add these non-intrusively so your public UI remains unchanged */
    #hostedAdRoot { display: none; position: fixed; inset: 0; z-index: 2000; background: rgba(6,8,10,0.85); align-items: center; justify-content: center; padding: 18px; }
    #hostedCard { width: min(960px, 96%); max-height: 92vh; background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01)); padding: 14px; border-radius: 12px; border: 1px solid rgba(255,255,255,0.04); display:flex; flex-direction:column; overflow:hidden; }
    .ad-player { width:100%; height:var(--ad-height,360px); border-radius:8px; overflow:hidden; background:#000; display:flex; align-items:center; justify-content:center; position:relative; }
    .controls { margin-top:12px; display:flex; gap:12px; align-items:center; justify-content:center; }
    #claimBtn { padding:10px 14px; border-radius:10px; background:linear-gradient(45deg,#ff6b9d,#c471ed); border:none; color:#fff; cursor:pointer; font-weight:800; font-size:14px; opacity:0; transform:scale(0.98); }
    #countdown { font-weight:700; font-size:18px; color:#fff; display:none; }
    /* circle */
    .circle-wrap { width:88px; height:88px; display:flex; align-items:center; justify-content:center; position:relative; }
    .loader-spinner { position:absolute; width:48px; height:48px; border-radius:50%; display:flex; align-items:center; justify-content:center; }
    .spinner-dot { width:8px; height:8px; border-radius:50%; background:rgba(255,255,255,0.9); opacity:0.12; animation:spinner 900ms linear infinite; }
    .spinner-dot:nth-child(2){ animation-delay:120ms; opacity:0.22 }
    .spinner-dot:nth-child(3){ animation-delay:240ms; opacity:0.32 }
    @keyframes spinner { 0%{ transform: translateY(-8px); }50%{ transform: translateY(0px); }100%{ transform: translateY(-8px); } }
    .progress-ring { width:88px; height:88px; transform: rotate(-90deg); }
    .ring-circle-bg { stroke: rgba(255,255,255,0.06); stroke-width:8; fill:none; }
    .ring-circle { stroke-linecap: round; stroke-width:8; fill:none; stroke: url(#ringGradient); }
    .circle-number { position:absolute; font-weight:800; font-size:20px; pointer-events:none; color:#fff; text-shadow:0 1px 0 rgba(0,0,0,0.6); }
    .circle-fadeout { animation:circleOut 380ms ease forwards; }
    @keyframes circleOut { to { transform: scale(0.85); opacity:0; } }
    .btn-pop { transform-origin:center; animation:popIn 420ms cubic-bezier(.2,.9,.3,1) forwards; }
    @keyframes popIn { 0% { transform: scale(0.6); opacity:0 } 60% { transform: scale(1.08); opacity:1 } 100% { transform: scale(1); } }
    @keyframes pulse { 0% { transform: translateY(0) } 50% { transform: translateY(-4px) } 100% { transform: translateY(0) } }
    .btn-pulse { animation: pulse 900ms ease-in-out infinite; }
    .hidden { display:none !important; }
  </style>

  <!-- preserve your quick view transition preference -->
  <style>@view-transition { navigation: auto; }</style>
</head>

<body>
  <!-- Animated Background Particles -->
  <div class="bg-particles" id="particles"></div>

  <!-- Header (kept as-is) -->
  <header class="header">
    <nav class="nav-container">
      <div class="logo" id="logo">GainGrid</div>
      <ul class="nav-menu">
        <li><a href="#home" class="nav-link">Home</a></li>
        <li><a href="#about" class="nav-link">About</a></li>
        <li><a href="#contact" class="nav-link">Contact</a></li>
        <li><a href="#" class="nav-link" style="color: #ff6b9d;">Launch Bot</a></li>
      </ul>
    </nav>
  </header>

  <!-- Main public content (kept exactly as you gave it) -->
  <main class="main-content" id="publicLanding">
    <!-- Hero Section -->
    <section class="hero" id="home">
      <div class="hero-content">
        <h1 class="hero-headline" id="heroHeadline">Earn Daily Rewards by Watching Ads &amp; Completing Tasks</h1>
        <p class="hero-subtitle" id="heroSubtitle">Join thousands earning G-Coin daily.</p>
        <div class="cta-buttons">
          <a href="#" class="btn btn-primary" id="ctaPrimary">Get Started</a>
          <a href="#about" class="btn btn-secondary" id="ctaSecondary">Learn More</a>
        </div>

        <!-- Dashboard Preview -->
        <div class="dashboard-preview">
          <div class="dashboard-mockup">
            <div class="mockup-header">
              <div class="mockup-dot dot-red"></div>
              <div class="mockup-dot dot-yellow"></div>
              <div class="mockup-dot dot-green"></div>
            </div>
            <div class="mockup-content">
              <div class="mockup-title">GainGrid Dashboard</div>
              <div class="mockup-stats">
                <div class="stat-card"><div class="stat-value">1,247</div><div class="stat-label">G-Coins</div></div>
                <div class="stat-card"><div class="stat-value">$24.50</div><div class="stat-label">USD Value</div></div>
                <div class="stat-card"><div class="stat-value">15</div><div class="stat-label">Tasks Done</div></div>
                <div class="stat-card"><div class="stat-value">VIP 2</div><div class="stat-label">Level</div></div>
              </div>
            </div>
          </div>
        </div>

      </div>
    </section>

    <!-- About Section -->
    <section class="about" id="about">
      <div class="about-container">
        <h2 class="about-heading" id="aboutHeading">What is GainGrid?</h2>
        <p class="about-description" id="aboutDescription">GainGrid is a Telegram-integrated reward system where users earn G-Coin by watching ads, completing simple tasks, and playing fun games. Withdraw in USD, BTC, and more.</p>
        <div class="features-grid">
          <div class="feature-card">
            <div class="feature-icon">👀</div>
            <h3 class="feature-title">Watch &amp; Earn</h3>
            <p class="feature-description">Watch engaging ads and earn G-Coins instantly. Simple, fast, and rewarding.</p>
          </div>
          <div class="feature-card">
            <div class="feature-icon">✅</div>
            <h3 class="feature-title">Complete Tasks</h3>
            <p class="feature-description">Finish easy tasks and surveys to boost your earnings every day.</p>
          </div>
          <div class="feature-card">
            <div class="feature-icon">💰</div>
            <h3 class="feature-title">Withdraw Easily</h3>
            <p class="feature-description">Convert your G-Coins to USD, BTC, or other cryptocurrencies seamlessly.</p>
          </div>
          <div class="feature-card">
            <div class="feature-icon">⭐</div>
            <h3 class="feature-title">VIP Levels</h3>
            <p class="feature-description">Unlock higher earning rates and exclusive rewards as you level up.</p>
          </div>
          <div class="feature-card">
            <div class="feature-icon">🤝</div>
            <h3 class="feature-title">Referral Bonuses</h3>
            <p class="feature-description">Invite friends and earn bonus G-Coins from their activities.</p>
          </div>
        </div>
      </div>
    </section>
  </main>

  <!-- Footer (kept) -->
  <footer class="footer">
    <div class="footer-container">
      <div class="social-links">
        <a href="#" class="social-link" title="Telegram">📱</a>
        <a href="#" class="social-link" title="YouTube">📺</a>
        <a href="#" class="social-link" title="Twitter">🐦</a>
        <a href="#" class="social-link" title="Discord">💬</a>
      </div>
      <p class="footer-text">© GainGrid 2025. All rights reserved.</p>
    </div>
  </footer>

  <!-- === Hidden hosted/deeplink ad UI (only shown when deeplink payload present) === -->
  <div id="hostedAdRoot" aria-hidden="true">
    <div id="hostedCard" role="dialog" aria-modal="true">
      <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px;">
        <div style="font-weight:900;font-size:18px;background:linear-gradient(90deg,#c471ed 0%,#ff6b9d 45%,#ff4d79 100%);-webkit-background-clip:text;-webkit-text-fill-color:transparent;">Gain-Grid</div>
        <div class="small" id="vipInfoHosted">VIP: —</div>
      </div>

      <div class="ad-player" id="adPlayerHosted" aria-live="polite">
        <div id="adPlaceholderHosted" class="small">Ad player area</div>

        <!-- Circular loader overlay -->
        <div id="circleContainer" style="position:absolute;right:18px;top:18px;display:none;z-index:60;">
          <div class="circle-wrap" id="circleWrap" role="progressbar" aria-valuemin="0" aria-valuemax="100" aria-valuenow="0">
            <svg class="progress-ring" viewBox="0 0 88 88" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
              <defs>
                <linearGradient id="ringGradient" x1="0%" y1="0%" x2="100%" y2="0%">
                  <stop offset="0%" stop-color="#c471ed"/>
                  <stop offset="50%" stop-color="#ff6b9d"/>
                  <stop offset="100%" stop-color="#ff4d79"/>
                </linearGradient>
              </defs>
              <circle class="ring-circle-bg" cx="44" cy="44" r="36"></circle>
              <circle class="ring-circle" cx="44" cy="44" r="36" stroke-dasharray="226.194" stroke-dashoffset="226.194"></circle>
            </svg>

            <div class="loader-spinner hidden" id="loaderSpinner" aria-hidden="true">
              <div class="spinner-dot"></div>
              <div class="spinner-dot"></div>
              <div class="spinner-dot"></div>
            </div>

            <div class="circle-number" id="circleNumber">—</div>
          </div>
        </div>

        <div class="progress-text" id="progressTextHosted" style="display:none">Loading…</div>
      </div>

      <div class="controls" id="controlsHosted" style="margin-top:12px;display:flex;gap:8px;align-items:center;justify-content:center;">
        <div class="countdown" id="countdownHosted">—</div>
        <button id="claimBtnHosted" class="btn" disabled>Claim / Send Result</button>
      </div>

      <div class="note" id="noteHosted" style="margin-top:8px;color:rgba(255,255,255,0.6);font-size:12px;text-align:center;">Waiting for deeplink...</div>
    </div>
  </div>

  <!-- Debug panel (kept hidden by default) -->
  <div id="dbg" style="position:fixed;right:10px;bottom:10px;padding:6px 8px;background:rgba(0,0,0,0.6);border-radius:6px;font-size:11px;color:#fff;z-index:9999;display:none">dbg</div>

  <!-- ===== Application JS: public UI + deeplink/ad logic combined (robust & non-invasive) ===== -->
  <script>
    // ---------- Basic config & helpers (kept names) ----------
    const BOT_WEBHOOK = "https://gaingrid.bots.business/loadweb"; // loadweb endpoint (kept)
    const HOSTED_SESSION_KEY = 'gg_hosted_authoritative_payload';
    const ADSTER_SCRIPT_KEY = 'a8702b8b4c48420a3815542007f1c0df';
    const ADSTER_SCRIPT_SRC = "//www.highperformanceformat.com/" + ADSTER_SCRIPT_KEY + "/invoke.js";
    const CUSTOM_PROVIDER_URL = "https://experiencedbat.com/dbm/F.zudZGMN/vBZ_GeUM/Jelm/9ruAZ/UjlGkpPiTuYT2/ORDok/w/NEjDU-t/Ntj/Y/4_OhTuAb2iNQixZWs/aKWn1rpydHDr0IxU";

    const el = id => { try { return document.getElementById(id); } catch (e) { return null; } };
    function dbg(msg){ try{ const d = el('dbg'); if(d){ d.style.display='block'; d.textContent=String(msg).slice(0,160);} console.log('hosted:', msg);}catch(e){} }
    function nowISO(){ return (new Date()).toISOString(); }
    function randChoice(arr){ return arr && arr.length ? arr[Math.floor(Math.random()*arr.length)] : 30; }
    function safeParse(s){ try{ return JSON.parse(s); }catch(e){ return null; } }

    // minimal hash -> int for deterministic secs mapping
    function simpleHashToInt(s){
      try{
        const str = String(s||'');
        let h = 2166136261;
        for(let i=0;i<str.length;i++){ h ^= str.charCodeAt(i); h += (h<<1)+(h<<4)+(h<<7)+(h<<8)+(h<<24); }
        return Math.abs(h);
      }catch(e){ return Math.floor(Math.random()*1000000); }
    }

    // decode utilities (kept)
    function decodeBase64UrlSafe(raw){
      if(!raw) return null;
      try{
        let r = raw.replace(/\s+/g,'').replace(/-/g,'+').replace(/_/g,'/');
        const pad = r.length % 4;
        if(pad === 2) r += '=='; else if(pad === 3) r += '=';
        const dec = atob(r);
        try{ return JSON.parse(dec); }catch(e){ return dec; }
      }catch(e){ return null; }
    }
    function tryDecodePayloadString(raw){
      if(!raw) return null;
      try{
        if((raw.indexOf('%7B')===0 || raw.indexOf('%5B')===0) || raw.indexOf('%22') !== -1){
          try { return JSON.parse(decodeURIComponent(raw)); } catch(e){}
        }
        if(raw[0] === '{' || raw[0] === '['){
          try { return JSON.parse(raw); } catch(e){}
        }
        const maybe = decodeBase64UrlSafe(raw);
        if(maybe) return maybe;
        try{ return JSON.parse(decodeURIComponent(raw)); }catch(e){}
      }catch(e){}
      return null;
    }

    // ----- ad provider injection (kept) -----
    async function injectAdsense(holder){
      try{
        if(!holder) return false;
        holder.innerHTML = '';
        const ins = document.createElement('ins');
        ins.className = 'adsbygoogle';
        ins.style.display = 'block';
        ins.style.width = '100%';
        ins.style.height = '100%';
        ins.setAttribute('data-ad-client', 'ca-pub-2309008538670900');
        ins.setAttribute('data-ad-slot', '4194843603');
        holder.appendChild(ins);
        try{ (adsbygoogle = window.adsbygoogle || []).push({}); }catch(e){}
        return true;
      }catch(e){ return false; }
    }
    function injectCustomProvider(holder){
      try{
        if(!holder) return false;
        holder.innerHTML = '';
        const ifr = document.createElement('iframe');
        ifr.src = CUSTOM_PROVIDER_URL;
        ifr.style.border = '0';
        ifr.style.width = '100%';
        ifr.style.height = '100%';
        ifr.setAttribute('referrerpolicy','no-referrer');
        holder.appendChild(ifr);
        return true;
      }catch(e){ return false; }
    }
    function injectAdsterra(holder){
      try{
        if(!holder) return false;
        holder.innerHTML = '';
        const wrap = document.createElement('div');
        wrap.style.width = '100%'; wrap.style.height='100%'; wrap.style.display='flex'; wrap.style.alignItems='center'; wrap.style.justifyContent='center';
        holder.appendChild(wrap);
        const s1 = document.createElement('script'); s1.type='text/javascript';
        s1.text = "atOptions = { 'key' : '" + ADSTER_SCRIPT_KEY + "', 'format' : 'iframe', 'height' : 60, 'width' : 468, 'params' : {} };";
        const s2 = document.createElement('script'); s2.type='text/javascript'; s2.src = ADSTER_SCRIPT_SRC;
        wrap.appendChild(s1); wrap.appendChild(s2);
        return true;
      }catch(e){ return false; }
    }
    function showFallbackVideo(holder){
      try{
        if(!holder) return false;
        holder.innerHTML = '';
        const v = document.createElement('video');
        v.src = "https://storage.googleapis.com/interactive-media-ads/media/big_buck_bunny_trailer.mp4";
        v.autoplay = true; v.muted = true; v.playsInline = true; v.controls = false;
        v.style.width = '100%'; v.style.height = '100%';
        holder.appendChild(v);
        try{ v.play().catch(()=>{}); }catch(e){}
        return true;
      }catch(e){ return false; }
    }

    // compute secs (keeps mapping rules)
    function computeSecs(authoritativePayload){
      try{
        if(authoritativePayload && authoritativePayload.secs && !isNaN(Number(authoritativePayload.secs))){
          return Number(authoritativePayload.secs);
        }
        if(authoritativePayload && authoritativePayload.secs_min && authoritativePayload.secs_max){
          const min = Number(authoritativePayload.secs_min) || 0;
          const max = Number(authoritativePayload.secs_max) || min;
          if(max <= min) return min;
          if(authoritativePayload.user && (authoritativePayload.user.user_id || authoritativePayload.user_id)){
            const uid = (authoritativePayload.user.user_id || authoritativePayload.user_id);
            const h = simpleHashToInt(uid);
            return min + (h % (max - min + 1));
          }
          return Math.floor(Math.random()*(max-min+1)) + min;
        }
        if(authoritativePayload && Array.isArray(authoritativePayload.secs_list) && authoritativePayload.secs_list.length){
          if(authoritativePayload.user && (authoritativePayload.user.user_id || authoritativePayload.user_id)){
            const uid = (authoritativePayload.user.user_id || authoritativePayload.user_id);
            const h = simpleHashToInt(uid);
            return authoritativePayload.secs_list[h % authoritativePayload.secs_list.length];
          }
          return randChoice(authoritativePayload.secs_list);
        }
        const DURS = [30,40,50,60];
        if(authoritativePayload && authoritativePayload.user && (authoritativePayload.user.user_id || authoritativePayload.user_id)){
          const uid = (authoritativePayload.user.user_id || authoritativePayload.user_id);
          const h = simpleHashToInt(uid);
          return DURS[h % DURS.length];
        }
        return randChoice(DURS);
      }catch(e){
        return 30;
      }
    }

    // ring helpers
    const ringRadius = 36;
    const ringCirc = 2 * Math.PI * ringRadius; // stroke-dasharray

    function setRingProgress(percent){
      try{
        const ring = document.querySelector('#hostedCard .ring-circle');
        if(!ring) return;
        const pct = Math.max(0, Math.min(100, Number(percent) || 0));
        const offset = Math.round(ringCirc * (1 - (pct/100)));
        try{ ring.setAttribute('stroke-dasharray', String(ringCirc)); ring.setAttribute('stroke-dashoffset', String(offset)); }catch(e){}
        const wrap = el('circleWrap'); if(wrap && typeof wrap.setAttribute === 'function') wrap.setAttribute('aria-valuenow', String(Math.round(pct)));
      }catch(e){}
    }

    // state
    let countdownTimer = null;
    let sessionActive = false;
    let sessionCompleted = false;
    let sessionPayload = null;

    // UI helpers
    function showHostedUI(){
      try{
        const root = el('hostedAdRoot'); if(root){ root.style.display = 'flex'; root.setAttribute('aria-hidden','false'); }
        const circleContainer = el('circleContainer'); if(circleContainer) circleContainer.style.display='block';
        const controls = el('controlsHosted'); if(controls) controls.style.display = 'flex';
        const note = el('noteHosted'); if(note) note.textContent = 'Deeplink payload received — preparing...';
      }catch(e){}
    }
    function hideHostedUI(){
      try{
        const root = el('hostedAdRoot'); if(root){ root.style.display = 'none'; root.setAttribute('aria-hidden','true'); }
      }catch(e){}
    }
    function showCircle(){ try{ const c = el('circleContainer'); if(c) c.style.display='block'; const spinner = el('loaderSpinner'); if(spinner) spinner.classList.remove('hidden'); const p = el('progressTextHosted'); if(p) p.style.display='block'; }catch(e){} }
    function hideCircle(){ try{ const cw = el('circleWrap'); if(cw && cw.classList) cw.classList.add('circle-fadeout'); setTimeout(()=>{ try{ const c = el('circleContainer'); if(c) c.style.display='none'; if(cw && cw.classList) cw.classList.remove('circle-fadeout'); }catch(e){} },420); const pt = el('progressTextHosted'); if(pt) pt.style.display='none'; }catch(e){} }
    function showClaimButton(){ try{ const btn = el('claimBtnHosted'); if(!btn) return; btn.disabled=false; if(!btn.classList.contains('btn-pop')) btn.classList.add('btn-pop'); if(!btn.classList.contains('btn-pulse')) btn.classList.add('btn-pulse'); btn.style.opacity='1'; btn.style.transform='scale(1)'; btn.scrollIntoView({behavior:'smooth', block:'center'}); }catch(e){} }
    function hideClaimButton(){ try{ const btn = el('claimBtnHosted'); if(btn){ btn.disabled=true; btn.style.opacity='0'; if(btn.classList.contains('btn-pulse')) btn.classList.remove('btn-pulse'); } }catch(e){} }

    // send to loadweb
    function sendToWebhook(data){
      return new Promise((resolve) => {
        try{
          const wrapper = { action: 'ads_validate', payload: data, meta: { ts: Date.now(), host: location.href } };
          const body = JSON.stringify(wrapper);
          let sent = false;
          try{
            if(navigator.sendBeacon){
              try{ const blob = new Blob([body], { type: 'application/json' }); sent = navigator.sendBeacon(BOT_WEBHOOK, blob); }catch(be){ sent=false; }
            }
          }catch(e){ sent=false; }
          if(sent){ dbg('webhook sent via beacon: ' + (data.status||'')); const note=el('noteHosted'); if(note) note.textContent='Result posted to webhook.'; resolve(true); return; }
          fetch(BOT_WEBHOOK, { method:'POST', headers:{ 'Content-Type':'application/json' }, body: body, keepalive:true })
            .then(()=> { dbg('webhook sent fetch: ' + (data.status||'')); const note=el('noteHosted'); if(note) note.textContent='Result posted to webhook.'; resolve(true); })
            .catch(()=> { dbg('webhook fetch err'); const note=el('noteHosted'); if(note) note.textContent='Failed to post result'; resolve(false); });
        }catch(e){ dbg('sendToWebhook err'); const note=el('noteHosted'); if(note) note.textContent='Failed to post result'; resolve(false); }
      });
    }

    // close: Telegram.WebApp.close -> parent.postMessage -> window.close
    function requestCloseHost(){
      try{
        try{
          if(window.Telegram && Telegram.WebApp && typeof Telegram.WebApp.close === 'function'){ Telegram.WebApp.close(); return; }
        }catch(e){}
        try{ parent.postMessage({ type: 'close_hosted' }, '*'); }catch(e){}
        try{ window.close(); }catch(e){}
        setTimeout(()=>{ try{ parent.postMessage({ type: 'close_hosted' }, '*'); }catch(e){} try{ window.close(); }catch(e){} }, 250);
      }catch(e){}
    }

    // finalize skip
    function finalizeAsSkippedIfActive(reason){
      try{
        if(!sessionActive || sessionCompleted) return;
        sessionActive = false; sessionCompleted = false;
        const ad_id = sessionPayload && (sessionPayload.ad_id || sessionPayload.id) ? (sessionPayload.ad_id || sessionPayload.id) : ('host_ad_' + Date.now());
        const reward = sessionPayload && (sessionPayload.reward || sessionPayload.base) ? (sessionPayload.reward || sessionPayload.base) : 0;
        const result = {
          ad_id: ad_id,
          reward: reward,
          base: sessionPayload && sessionPayload.base || 0,
          vip_level: sessionPayload && (sessionPayload.vip_level || sessionPayload.vip) || null,
          user: sessionPayload && (sessionPayload.user || sessionPayload.user_id) || null,
          status: 'ad_skiped',
          reason: reason || 'user_navigated_or_closed',
          ts: nowISO(),
          original_payload: sessionPayload || null
        };
        sendToWebhook(result).then(()=>{}).catch(()=>{});
      }catch(e){}
    }

    // countdown + ring + automatic post + show claim
    function startCountdownAndReport(authoritativePayload, source = 'deeplink'){
      try{
        if(!authoritativePayload || typeof authoritativePayload !== 'object') return;
        try{ sessionStorage.setItem(HOSTED_SESSION_KEY, JSON.stringify(authoritativePayload)); }catch(e){}
        sessionActive = true; sessionCompleted = false; sessionPayload = authoritativePayload;

        const secs = Number(computeSecs(authoritativePayload)) || 30;
        const ad_id = authoritativePayload.ad_id || authoritativePayload.id || ('host_ad_' + Date.now());
        const reward = authoritativePayload.reward || authoritativePayload.r || authoritativePayload.base || 0;

        // show hosted UI
        showHostedUI();
        el('noteHosted').textContent = `Ad: ${ad_id} — preparing ${secs}s`;
        hideClaimButton();

        // show ad provider in hosted ad area
        (async ()=>{
          const holder = el('adPlayerHosted') || el('adPlaceholderHosted');
          let ok = false;
          try { ok = await injectAdsense(holder); } catch(e) { ok = false; }
          if(!ok) ok = injectCustomProvider(holder);
          if(!ok) ok = injectAdsterra(holder);
          if(!ok) showFallbackVideo(holder);
        })();

        // show circle loader then run countdown
        showCircle();
        const spinner = el('loaderSpinner'); if(spinner) spinner.classList.remove('hidden');
        const circleNumber = el('circleNumber'); if(circleNumber) circleNumber.textContent = '';
        setRingProgress(0);
        const ptext = el('progressTextHosted'); if(ptext) ptext.textContent = 'Loading…';

        // clear previous timer
        try{ if(countdownTimer) clearInterval(countdownTimer); countdownTimer = null; }catch(e){}

        setTimeout(()=>{
          try{
            if(spinner) spinner.classList.add('hidden');
            let remaining = secs;
            if(circleNumber) circleNumber.textContent = String(remaining);
            setRingProgress(0);
            if(ptext) ptext.textContent = `0 / ${secs}s`;

            const startTs = Date.now();
            countdownTimer = setInterval(()=>{
              try{
                const elapsed = Math.floor((Date.now() - startTs)/1000);
                const pct = Math.min(100, Math.round((elapsed / secs) * 100));
                setRingProgress(pct);
                if(ptext) ptext.textContent = `${elapsed} / ${secs}s`;
                const newRemaining = Math.max(0, secs - elapsed);
                if(circleNumber) circleNumber.textContent = String(newRemaining);
                const cd = el('countdownHosted'); if(cd) cd.textContent = String(newRemaining);

                if(newRemaining <= 0){
                  try{ clearInterval(countdownTimer); countdownTimer = null; }catch(e){}
                  sessionCompleted = true; sessionActive = false;
                  el('noteHosted').textContent = 'Countdown finished — result posted to webhook.';
                  const result = {
                    ad_id: ad_id,
                    reward: reward,
                    base: authoritativePayload.base || 0,
                    vip_level: authoritativePayload.vip_level || authoritativePayload.vip || null,
                    user: authoritativePayload.user || authoritativePayload.user_id || null,
                    status: 'completed',
                    ts: nowISO(),
                    original_payload: authoritativePayload
                  };
                  sendToWebhook(result).then(()=>{}).catch(()=>{});
                  hideCircle();
                  setTimeout(()=>{ showClaimButton(); el('noteHosted').textContent = 'Tap Claim to confirm and close.'; }, 320);
                }
              }catch(inner){ console.warn('tick', inner); }
            }, 250);
          }catch(e){ console.warn('start tick err', e); dbg('count errors'); }
        }, 700);

        // manual claim (preserve)
        try{
          const btn = el('claimBtnHosted');
          if(btn){
            btn.onclick = function(){
              try{
                if(btn.disabled) return;
                btn.disabled = true;
                if(btn.classList.contains('btn-pulse')) btn.classList.remove('btn-pulse');
                sessionCompleted = true; sessionActive = false;
                const result = {
                  ad_id: ad_id,
                  reward: reward,
                  base: authoritativePayload.base || 0,
                  vip_level: authoritativePayload.vip_level || authoritativePayload.vip || null,
                  user: authoritativePayload.user || authoritativePayload.user_id || null,
                  status: 'claimed_manual',
                  ts: nowISO(),
                  original_payload: authoritativePayload
                };
                sendToWebhook(result).then(()=>{ requestCloseHost(); }).catch(()=>{ requestCloseHost(); });
              }catch(e){ console.warn('claim err', e); }
            };
          }
        }catch(e){}
      }catch(e){ console.warn('start err', e); dbg('count err'); }
    }

    // lifecycle events -> send ad_skiped when appropriate
    window.addEventListener('beforeunload', function(){ try{ finalizeAsSkippedIfActive('beforeunload'); }catch(e){} });
    window.addEventListener('pagehide', function(){ try{ finalizeAsSkippedIfActive('pagehide'); }catch(e){} });
    document.addEventListener('visibilitychange', function(){
      try{ if(document.visibilityState === 'hidden'){ setTimeout(()=>{ if(document.visibilityState === 'hidden') finalizeAsSkippedIfActive('visibility_hidden'); }, 1200); } }catch(e){}
    });

    // postMessage listener (kept)
    window.addEventListener('message', function(ev){
      try{
        const d = ev.data || {};
        if(!d || typeof d !== 'object') return;
        if(d.type === 'start_payload' && d.payload){
          const payload = d.payload;
          let obj = null;
          if(typeof payload === 'string') obj = tryDecodePayloadString(payload); else obj = payload;
          if(obj && typeof obj === 'object'){ el('noteHosted').textContent = 'PostMessage payload received.'; startCountdownAndReport(obj,'postmessage'); }
          return;
        }
        if(d.type === 'close_hosted'){ try{ window.close(); }catch(e){} return; }
      }catch(e){}
    }, false);

    // decode incoming payloads from query/hash (kept)
    function getQueryParams(){
      const s = location.search.replace(/^\?/,''); if(!s) return {};
      return s.split('&').filter(Boolean).map(p=>{ const i=p.indexOf('='); if(i<0) return [decodeURIComponent(p),'']; return [decodeURIComponent(p.slice(0,i)), decodeURIComponent(p.slice(i+1))]; }).reduce((o,[k,v])=>{ o[k]=v; return o; }, {});
    }

    // boot: determine public vs deeplink
    function boot(){
      try{
        const qp = getQueryParams();
        if(qp.start){
          const decoded = tryDecodePayloadString(qp.start);
          if(decoded && typeof decoded === 'object'){
            // show hosted ad UI
            el('publicLanding').style.display = 'none';
            showHostedUI();
            startCountdownAndReport(decoded);
            return;
          }
        }

        // hash based deeplink (kept)
        const hraw = (location.hash || '').replace(/^#/,'');
        if(hraw){
          if(hraw.startsWith('/')){
            const parts = hraw.split('?'); const path = parts[0].replace(/^\//,'');
            const hashQP = {};
            if(parts[1]) parts[1].split('&').forEach(p=>{ const i=p.indexOf('='); if(i>=0) hashQP[decodeURIComponent(p.slice(0,i))]=decodeURIComponent(p.slice(i+1)); else hashQP[decodeURIComponent(p)]=''; });
            if(path === 'ad' && (hashQP.ad_id || hashQP.id || hashQP.start)){
              if(hashQP.start){
                const dec = tryDecodePayloadString(hashQP.start);
                if(dec && typeof dec === 'object'){ el('publicLanding').style.display = 'none'; showHostedUI(); startCountdownAndReport(dec); return; }
              }
              const payload = { ad_id: hashQP.ad_id || hashQP.id, secs: hashQP.secs || hashQP.duration, reward: hashQP.reward || hashQP.base, user: { user_id: hashQP.user_id || hashQP.uid || null } };
              el('publicLanding').style.display = 'none';
              showHostedUI();
              startCountdownAndReport(payload);
              return;
            }
          } else {
            const decoded = tryDecodePayloadString(decodeURIComponent(hraw));
            if(decoded && typeof decoded === 'object'){ el('publicLanding').style.display = 'none'; showHostedUI(); startCountdownAndReport(decoded); return; }
          }
        }

        // no authoritative payload -> PUBLIC mode (keep landing visible)
        el('publicLanding').style.display = 'block';
        hideHostedUI();
      }catch(e){ console.warn('boot err', e); dbg('boot err'); }
    }

    // initialize public bits (particles, scrolling, animations) - preserve original logic
    (function initPublicUI(){

      // particles
      function createParticles() {
        const particlesContainer = document.getElementById('particles');
        if(!particlesContainer) return;
        const particleCount = 50;
        for (let i = 0; i < particleCount; i++) {
          const particle = document.createElement('div');
          particle.className = 'particle';
          particle.style.left = Math.random() * 100 + '%';
          particle.style.top = Math.random() * 100 + '%';
          particle.style.animationDelay = Math.random() * 6 + 's';
          particle.style.animationDuration = (Math.random() * 3 + 3) + 's';
          particlesContainer.appendChild(particle);
        }
      }

      // smooth scroll
      function initSmoothScrolling() {
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
          anchor.addEventListener('click', function (e) {
            e.preventDefault();
            const target = document.querySelector(this.getAttribute('href'));
            if (target) target.scrollIntoView({ behavior: 'smooth', block: 'start' });
          });
        });
      }

      // scroll effects
      function initScrollEffects() {
        const observerOptions = { threshold: 0.1, rootMargin: '0px 0px -50px 0px' };
        const observer = new IntersectionObserver((entries) => {
          entries.forEach(entry => {
            if (entry.isIntersecting) {
              entry.target.style.opacity = '1';
              entry.target.style.transform = 'translateY(0)';
            }
          });
        }, observerOptions);

        document.querySelectorAll('.feature-card').forEach(card => {
          card.style.opacity = '0';
          card.style.transform = 'translateY(30px)';
          card.style.transition = 'all 0.6s ease';
          observer.observe(card);
        });
      }

      // Element SDK mapping - preserve
      const defaultConfig = {
        hero_headline: "Earn Daily Rewards by Watching Ads & Completing Tasks",
        hero_subtitle: "Join thousands earning G-Coin daily.",
        about_heading: "What is GainGrid?",
        about_description: "GainGrid is a Telegram-integrated reward system where users earn G-Coin by watching ads, completing simple tasks, and playing fun games. Withdraw in USD, BTC, and more.",
        cta_primary: "Get Started",
        cta_secondary: "Learn More",
        background_color: "#0f1419",
        surface_color: "#1a2332",
        text_color: "#ffffff",
        primary_action_color: "#ff6b9d",
        secondary_action_color: "#12c2e9",
        font_family: "Inter",
        font_size: 16
      };

      function onConfigChange(config){
        const heroHeadline = document.getElementById('heroHeadline');
        const heroSubtitle = document.getElementById('heroSubtitle');
        const aboutHeading = document.getElementById('aboutHeading');
        const aboutDescription = document.getElementById('aboutDescription');
        const ctaPrimary = document.getElementById('ctaPrimary');
        const ctaSecondary = document.getElementById('ctaSecondary');

        if (heroHeadline) heroHeadline.textContent = config.hero_headline || defaultConfig.hero_headline;
        if (heroSubtitle) heroSubtitle.textContent = config.hero_subtitle || defaultConfig.hero_subtitle;
        if (aboutHeading) aboutHeading.textContent = config.about_heading || defaultConfig.about_heading;
        if (aboutDescription) aboutDescription.textContent = config.about_description || defaultConfig.about_description;
        if (ctaPrimary) ctaPrimary.textContent = config.cta_primary || defaultConfig.cta_primary;
        if (ctaSecondary) ctaSecondary.textContent = config.cta_secondary || defaultConfig.cta_secondary;

        const backgroundColor = config.background_color || defaultConfig.background_color;
        const surfaceColor = config.surface_color || defaultConfig.surface_color;
        const textColor = config.text_color || defaultConfig.text_color;
        document.body.style.background = `linear-gradient(135deg, ${backgroundColor} 0%, ${surfaceColor} 50%, ${backgroundColor} 100%)`;
        document.body.style.color = textColor;
        const customFont = config.font_family || defaultConfig.font_family;
        const baseFontStack = '-webkit-system, BlinkMacSystemFont, sans-serif';
        document.body.style.fontFamily = `${customFont}, ${baseFontStack}`;
        const baseSize = config.font_size || defaultConfig.font_size;
        document.documentElement.style.fontSize = `${baseSize}px`;
      }

      if (window.elementSdk) {
        window.elementSdk.init({ defaultConfig, onConfigChange });
      }

      // wire up public UI
      document.addEventListener('DOMContentLoaded', function(){
        createParticles();
        initSmoothScrolling();
        initScrollEffects();
      });
    })();

    // run boot immediately (no delay)
    boot();

  </script>

  <!-- Cloudflare helper iframe snippet preserved (keeps original behavior) -->
  <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'997477bb430563ca',t:'MTc2MTkyNzUwMC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script>
</body>
</html>